<!DOCTYPE html>
<html>
<head>
  <meta charset=utf-8 />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firebase Cloud Messaging Example</title>

  <link rel="stylesheet" href="css/main.css">
  <link rel="manifest" href="/manifest.json">

</head>
<body>



    <h2>Подписка на пуш уведомления</h2>


    <b>Тестирование подписки на push уведомления Firebase Cloud Messaging.</b><br>    
    Отправка уведомлений производится со <a href="send.html" target="_blank">страницы отправки уведомлений</a>.
    Откройте консоль браузера для просмотра результатов операций.
    <br><br>
    
 


    
    1. Запросить разрешение на получение сообщений. <br><br>
    <button onclick="requestPermission()">Запросить разрешение</button> <br><br>    

    
    2. Получить токен браузера. <br><br>
    <button onclick="getCurrentToken()">Получить токен</button>
    <button onclick="deleteToken()" class="button-outline">Удалить токен</button>   
    <div style="display:grid; grid-template-columns: 1fr auto;" >
        <input id="token" type="text"  style="border-radius: 4px 0 0 4px;" />    
        <button class="button button-outline far fa-copy" style="border-radius: 0 4px 4px 0;" 
            onclick="document.querySelector('#token').select(); document.execCommand('copy');" >copy</button>
    </div>
    <br>


    
    3. Подписать токен на получение сообщений по теме (топику) 'rgru' <br><br>
    <button onclick="subscribeToRGRU(IID_TOKEN)">Подписать токен на 'rgru'</button>
    <button onclick="unsubscribeFromRGRU(IID_TOKEN)" class="button-outline">Отписать токен от 'rgru'</button>
    <br>
    <br>


    Теперь нужно перейти на  
    <a href="send.html" target="_blank">страницу отправки уведомлений</a> 
    и опубликовать сообщения.<br>
    Полученные сообщения будут показаны ниже, если эта страница является верхней в браузере. 
    Если браузер скрыт или эта страница не является верхней компьютер пользователя
    покажет всплывающее уведомление.<br><br>

    
    <h4>Полученные сообщения</h4>
    <button onclick="document.querySelector('#messages').innerHTML = '';" class="button-outline">Удалить полученные сообщения</button><br>
    <div id="messages"></div>


    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.9.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.9.3/firebase-messaging.js"></script>

    <script src="js/functions.js"></script>
    <script src="js/index.js"></script>
</body>
</html>
